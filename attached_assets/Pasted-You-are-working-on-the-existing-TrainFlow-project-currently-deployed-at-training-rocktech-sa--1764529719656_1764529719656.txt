You are working on the **existing TrainFlow project** currently deployed at `training.rocktech.sa`.

⚠️ VERY IMPORTANT CONSTRAINTS
- Do NOT change or remove the current email/password auth flow.
- Do NOT change the landing page design or routing logic between `/` and `/login`.
- Do NOT drop tables or wipe existing data in the Postgres database.
- Do NOT revert to Replit OAuth — keep our own auth (admin@democorp.local / TrainFlow123! etc.).
- Keep the existing role system and sidebar structure exactly as it is now.

My main problem:
- The **frontend pages are NOT using real backend data**.
- The database already has real rows (users, courses, enrollments, renewal_requests, notifications, etc.), but the UI shows **empty lists**, **0 totals**, and **empty dropdowns**.
- Example:  
  - `/users` shows “No users found” even though the `users` table has many rows.  
  - On `/enrollments`, “New Enrollment” dialog shows empty “Employee” and “Course” dropdowns.  

Your mission: **connect the full frontend to the real backend APIs, make all CRUD operations work, and seed more demo data.**  

You must do this CAREFULLY without breaking login, roles, or routing.

------------------------------------------------
1) VERIFY BACKEND & DATABASE CONNECTION
------------------------------------------------
1. Inspect the backend code (Express / Node server under `server/` and any DB layer such as Drizzle / Prisma).
2. Confirm which Postgres database URL is used (from env vars) and verify it matches the one shown in Replit’s Database UI where I see tables like:
   - `users`
   - `departments`
   - `courses`
   - `enrollments`
   - `renewal_requests`
   - `notifications`
   - `ai_recommendations`
   - `audit_logs`
   - `sessions`
3. Make sure the backend is actually reading & writing to these tables (NO in-memory mocks or separate SQLite/JSON data).

If backend is already wired correctly, don’t change the schema — only **add rows** where needed.

------------------------------------------------
2) API ENDPOINTS – ENSURE REAL DATA
------------------------------------------------
For each main domain, ensure there are working REST endpoints returning real DB data for the **current tenant** and **respecting roles**:

- Users
  - `GET /api/v1/users` – list users (admin / training officer only)
  - `POST /api/v1/users` – create user
  - `PATCH /api/v1/users/:id` – update user (role, status, etc.)
  - Must return data in camelCase: `id, firstName, lastName, email, role, grade, jobTitle, departmentId, createdAt, isActive`.

- Departments
  - `GET /api/v1/departments`
  - `POST /api/v1/departments`
  - `GET /api/v1/departments/:id/users` – optional helper to fetch members of a department.

- Courses
  - `GET /api/v1/courses`
  - `POST /api/v1/courses`

- Enrollments
  - `GET /api/v1/enrollments`
  - `POST /api/v1/enrollments`
  - Every enrollment row should include: `employeeId, courseId, expiryDate, status, certificateNumber`.

- Renewal Requests
  - `GET /api/v1/renewals`
  - `POST /api/v1/renewals`
  - Approval endpoints if they already exist (approve / reject).

- Notifications
  - `GET /api/v1/notifications` (for current user).

- AI Recommendations
  - `GET /api/v1/ai/recommendations` (can be stubbed but must read FROM TABLE if rows exist).

All these endpoints must:
- Use the same **session-based auth** we just fixed (`/api/v1/users/login` + `/api/v1/users/me`).
- Filter by the authenticated user’s tenant if multi-tenant logic already exists.
- Return JSON in the format expected by the React client (camelCase).

------------------------------------------------
3) FRONTEND – CONNECT PAGES TO BACKEND
------------------------------------------------
The active frontend is under `client/` (Vite React app). There are already pages and components for:

- Dashboard: `/dashboard`
- Course Management: `/courses`
- Enrollments: `/enrollments`
- All Renewals: `/all-renewals`
- User Management: `/users`
- Departments: `/departments`
- KPI Dashboard: `/kpi-dashboard`
- etc.

Your task is to make ALL of these use **real API calls** instead of placeholder / mocked / empty data.

Concretely:

1. Identify the API layer (e.g. `client/src/api/*.ts` or `client/src/services/api.ts`).
2. For each page:
   - Replace any hardcoded arrays with `useEffect` + `fetch` / `axios` calls to the correct `/api/v1/...` endpoints.
   - Use `credentials: "include"` so cookies (session) are sent.
   - On success, update React state and render real rows.
3. User Management (`/users`):
   - Should call `GET /api/v1/users` on load and show all users from DB (except maybe system users depending on role).
   - The “New User” / “Edit User” flow should call `POST` / `PATCH` and then **refetch** the list.
4. Enrollments (`/enrollments`):
   - “Employee” dropdown: populated from `GET /api/v1/users?role=employee` (or from `/api/v1/users` filtered in client).
   - “Course” dropdown: populated from `GET /api/v1/courses`.
   - After creating an enrollment, the new row must appear in the table and in the DB.
5. Dashboard tiles:
   - Use real counts from backend (`/api/v1/kpi/overview` or equivalent) OR compute counts from `users`, `enrollments`, `renewal_requests`.
   - No hardcoded zeros.

Make sure:
- All API base URLs are consistent (e.g. relative `/api/v1/...` so it works on `training.rocktech.sa`).
- Error states are handled with toasts/snackbars but **do NOT silently swallow errors**.

------------------------------------------------
4) ROLE-BASED DATA & PERMISSIONS
------------------------------------------------
Keep the **existing role & sidebar logic**, but ensure data respects roles:

- Admin:
  - Full access to User Management, Departments, Courses, Enrollments, All Renewals, KPI, Audit Logs, etc.
- Training Officer:
  - Similar to Admin except maybe limited admin-only pages (follow current code structure).
- Manager / Foreman:
  - Can see only their team’s renewals, approvals, etc.  
    If current code already filters by `managerId` or `supervisorId`, use that logic.
- Employee:
  - Can see only **their own** courses, renewals, tasks, recommendations.

You must:
- Reuse the existing `useAuth` hook and any existing role guards; just make sure pages use the authenticated user’s info (`/api/v1/users/me`).
- Not change route paths; only ensure they are protected and show correct data.

------------------------------------------------
5) DEMO DATA – SEED MORE REALISTIC RECORDS
------------------------------------------------
We already have some rows, but I want **richer demo data** for testing and demos.

Create a **new backend seed script or endpoint** (do NOT wipe existing data):

- Example: `POST /api/v1/admin/seed-demo-v2`
- Only accessible to admin users.
- Idempotent: running it multiple times should NOT create duplicate emails or weird duplicates.

Seed at least:
- 1 demo tenant (if you use tenants).
- 5+ departments.
- 20+ users:
  - 2 admins
  - 2 training officers
  - 4 managers
  - 4 foremen
  - 10+ employees
- 10+ courses with different validity periods and mandatory flags.
- 30+ enrollments across employees and courses with different statuses (active, expired, expiringSoon).
- 15+ renewal_requests (some pending, some approved, some rejected).
- 10+ notifications.
- 10+ ai_recommendations rows (can be stub recommendations referencing real userIds/courseIds).

After seeding:
- `/users` should be full of demo users.
- `/enrollments` should show many rows.
- Dashboard and KPI cards should show **non-zero** numbers.

Document the seed endpoint and default passwords in `replit.md` so I know how to re-run it.

------------------------------------------------
6) FINAL VALIDATION CHECKLIST
------------------------------------------------
Before you stop, validate ALL of the following in the running app:

1. Login:
   - `/login` works with: `admin@democorp.local` / `TrainFlow123!`
   - After login I see the **dashboard with sidebar**, NOT the public landing hero.

2. User Management:
   - `/users` shows real rows from DB.
   - Creating a new user via the UI inserts into the `users` table.
   - Editing a user persists changes.

3. Enrollments:
   - “New Enrollment” dialog shows real employees and real courses.
   - Creating an enrollment shows up in table **and** in `enrollments` DB table.

4. Departments:
   - Departments page lists departments from DB.
   - I can create/edit departments and see them in the DB.

5. Renewals & Approvals:
   - `/all-renewals` shows renewal_requests from DB.
   - Approving/rejecting through UI updates DB row.

6. Role behaviour:
   - When logging in as manager, foreman, or employee demo users, the sidebar and accessible pages match the role.
   - Employees only see their own data.

7. No 404/401 spam:
   - Open DevTools → Network tab and ensure the app is not spamming failing calls (404/401) after login.

When everything above is working, add a short **“Implementation Status”** summary at the top of `replit.md` describing:
- Which APIs are wired to which pages.
- Seed endpoint name.
- Demo accounts and passwords.

Do NOT change visual design (except tiny fixes if needed). Focus on **full backend ↔ frontend integration with real database data and working CRUD**.
